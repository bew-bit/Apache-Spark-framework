{"paragraphs":[{"title":"Загрузка данных","text":"%pyspark\ndf = spark.table(\"homework.bank\")\ndf.show()","user":"aleksandriiskaia","dateUpdated":"2021-06-05T18:17:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------------+-------+---------+-------+-------+-------+----+--------+---+-----+--------+--------+-----+--------+--------+---+\n|age|          job|marital|education|default|balance|housing|loan| contact|day|month|duration|campaign|pdays|previous|poutcome|  y|\n+---+-------------+-------+---------+-------+-------+-------+----+--------+---+-----+--------+--------+-----+--------+--------+---+\n| 30|   unemployed|married|  primary|     no|   1787|     no|  no|cellular| 19|  oct|      79|       1|   -1|       0| unknown| no|\n| 33|     services|married|secondary|     no|   4789|    yes| yes|cellular| 11|  may|     220|       1|  339|       4| failure| no|\n| 35|   management| single| tertiary|     no|   1350|    yes|  no|cellular| 16|  apr|     185|       1|  330|       1| failure| no|\n| 30|   management|married| tertiary|     no|   1476|    yes| yes| unknown|  3|  jun|     199|       4|   -1|       0| unknown| no|\n| 59|  blue-collar|married|secondary|     no|      0|    yes|  no| unknown|  5|  may|     226|       1|   -1|       0| unknown| no|\n| 35|   management| single| tertiary|     no|    747|     no|  no|cellular| 23|  feb|     141|       2|  176|       3| failure| no|\n| 36|self-employed|married| tertiary|     no|    307|    yes|  no|cellular| 14|  may|     341|       1|  330|       2|   other| no|\n| 39|   technician|married|secondary|     no|    147|    yes|  no|cellular|  6|  may|     151|       2|   -1|       0| unknown| no|\n| 41| entrepreneur|married| tertiary|     no|    221|    yes|  no| unknown| 14|  may|      57|       2|   -1|       0| unknown| no|\n| 43|     services|married|  primary|     no|    -88|    yes| yes|cellular| 17|  apr|     313|       1|  147|       2| failure| no|\n| 39|     services|married|secondary|     no|   9374|    yes|  no| unknown| 20|  may|     273|       1|   -1|       0| unknown| no|\n| 43|       admin.|married|secondary|     no|    264|    yes|  no|cellular| 17|  apr|     113|       2|   -1|       0| unknown| no|\n| 36|   technician|married| tertiary|     no|   1109|     no|  no|cellular| 13|  aug|     328|       2|   -1|       0| unknown| no|\n| 20|      student| single|secondary|     no|    502|     no|  no|cellular| 30|  apr|     261|       1|   -1|       0| unknown|yes|\n| 31|  blue-collar|married|secondary|     no|    360|    yes| yes|cellular| 29|  jan|      89|       1|  241|       1| failure| no|\n| 40|   management|married| tertiary|     no|    194|     no| yes|cellular| 29|  aug|     189|       2|   -1|       0| unknown| no|\n| 56|   technician|married|secondary|     no|   4073|     no|  no|cellular| 27|  aug|     239|       5|   -1|       0| unknown| no|\n| 37|       admin.| single| tertiary|     no|   2317|    yes|  no|cellular| 20|  apr|     114|       1|  152|       2| failure| no|\n| 25|  blue-collar| single|  primary|     no|   -221|    yes|  no| unknown| 23|  may|     250|       1|   -1|       0| unknown| no|\n| 31|     services|married|secondary|     no|    132|     no|  no|cellular|  7|  jul|     148|       1|  152|       1|   other| no|\n+---+-------------+-------+---------+-------+-------+-------+----+--------+---+-----+--------+--------+-----+--------+--------+---+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=7"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1622913635053_428749313","id":"20210605-172035_149833357","dateCreated":"2021-06-05T17:20:35+0000","dateStarted":"2021-06-05T18:15:00+0000","dateFinished":"2021-06-05T18:15:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20022"},{"title":"1. Построить распределения клиентов по возрастам","text":"%sql \nselect age, count(*) value \nfrom homework.bank\ngroup by age \norder by age","user":"aleksandriiskaia","dateUpdated":"2021-06-05T19:24:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n19\t4\n20\t3\n21\t7\n22\t9\n23\t20\n24\t24\n25\t44\n26\t77\n27\t94\n28\t103\n29\t97\n30\t150\n31\t199\n32\t224\n33\t186\n34\t231\n35\t180\n36\t188\n37\t161\n38\t159\n39\t130\n40\t142\n41\t135\n42\t141\n43\t115\n44\t105\n45\t112\n46\t119\n47\t108\n48\t114\n49\t112\n50\t101\n51\t91\n52\t86\n53\t94\n54\t71\n55\t90\n56\t74\n57\t91\n58\t85\n59\t71\n60\t47\n61\t16\n62\t7\n63\t8\n64\t7\n65\t6\n66\t9\n67\t5\n68\t2\n69\t6\n70\t7\n71\t6\n72\t4\n73\t6\n74\t3\n75\t6\n76\t2\n77\t6\n78\t3\n79\t4\n80\t6\n81\t1\n83\t4\n84\t1\n86\t1\n87\t1\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=40"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1622916585033_-1904028456","id":"20210605-180945_2076691867","dateCreated":"2021-06-05T18:09:45+0000","dateStarted":"2021-06-05T18:40:34+0000","dateFinished":"2021-06-05T18:40:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20023"},{"title":"2. Распределение по возрасту с динамическим численным параметром max_age","text":"%sql \r\nselect age, count(1) value \r\nfrom homework.bank \r\nwhere age <= ${max_age=40} \r\ngroup by age \r\norder by age","user":"aleksandriiskaia","dateUpdated":"2021-06-05T19:24:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{"maxAge":"40","max_age":"40"},"forms":{"max_age":{"type":"TextBox","name":"max_age","defaultValue":"40","hidden":false,"$$hashKey":"object:20971"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n19\t4\n20\t3\n21\t7\n22\t9\n23\t20\n24\t24\n25\t44\n26\t77\n27\t94\n28\t103\n29\t97\n30\t150\n31\t199\n32\t224\n33\t186\n34\t231\n35\t180\n36\t188\n37\t161\n38\t159\n39\t130\n40\t142\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=14"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1622915927292_2127717353","id":"20210605-175847_1292780649","dateCreated":"2021-06-05T17:58:47+0000","dateStarted":"2021-06-05T18:20:59+0000","dateFinished":"2021-06-05T18:21:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20024"},{"title":"3. Распределение по возрасту с динамическим параметром “marital”","text":"%pyspark\ndf.groupBy(\"marital\").count().show()","user":"aleksandriiskaia","dateUpdated":"2021-06-05T18:32:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----+\n| marital|count|\n+--------+-----+\n|divorced|  528|\n| married| 2797|\n|  single| 1196|\n+--------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=31","http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=32","http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=33","http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=34","http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=35"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1622916561391_-2143297705","id":"20210605-180921_817194852","dateCreated":"2021-06-05T18:09:21+0000","dateStarted":"2021-06-05T18:32:28+0000","dateFinished":"2021-06-05T18:32:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20025"},{"text":"%sql\nselect age, count(1) value \nfrom homework.bank \nwhere marital = ${marital=\"married\",\"single\"|\"married\"|\"divorced\"} \ngroup by age \norder by age","user":"aleksandriiskaia","dateUpdated":"2021-06-05T19:25:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","runOnSelectionChange":true},"settings":{"params":{"marital":"\"married\""},"forms":{"marital":{"type":"Select","options":[{"value":"\"single\"","$$hashKey":"object:21033"},{"value":"\"married\"","$$hashKey":"object:21034"},{"value":"\"divorced\"","$$hashKey":"object:21035"}],"name":"marital","defaultValue":"\"married\"","hidden":false,"$$hashKey":"object:21024"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n23\t3\n24\t11\n25\t11\n26\t18\n27\t26\n28\t23\n29\t37\n30\t56\n31\t104\n32\t105\n33\t103\n34\t142\n35\t109\n36\t117\n37\t100\n38\t99\n39\t88\n40\t105\n41\t97\n42\t91\n43\t79\n44\t68\n45\t76\n46\t82\n47\t78\n48\t91\n49\t87\n50\t74\n51\t63\n52\t66\n53\t75\n54\t56\n55\t68\n56\t50\n57\t78\n58\t67\n59\t56\n60\t36\n61\t15\n62\t5\n63\t7\n64\t6\n65\t4\n66\t7\n67\t5\n68\t1\n69\t5\n70\t5\n71\t5\n72\t4\n73\t6\n74\t2\n75\t3\n76\t1\n77\t5\n78\t2\n79\t3\n80\t6\n81\t1\n83\t2\n86\t1\n87\t1\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://bigdataanalytics2-head-shdpt-v31-1-0.novalocal:4040/jobs/job?id=57"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1622920515159_893224881","id":"20210605-191515_373804059","dateCreated":"2021-06-05T19:15:15+0000","dateStarted":"2021-06-05T19:23:25+0000","dateFinished":"2021-06-05T19:23:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20026"}],"name":"/aleksandriiskaia/work#1","id":"2G9BSJWW6","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark2::2G9BSJWW6":[],"sh:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}